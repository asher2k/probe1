# ep2k_asm
{{tag>ep2k doc readme ydisk}}

# Проект сборки ПО МПСУ-007 для ЭП2К

Проект предназначен для автоматизации сборки и хранения ПО МПСУ-007 для локомотива ЭП2К. Сборка архива для распространения, а так же архивов для выпуска извещения и сертификации, осуществляется с помощью скриптов на языке `python`.

Сборка для распространения может быть развёрнута на usb-flash носитель с помощью утилиты `UFD`.

## Структура проекта

`/pkg` - файлы для сборки исполняемого ПО.  
`/src` - файлы исходного ПО для сертификации и передачи в архив.  
`/distr` - директория хранения всех формируемых сборок исполняемого ПО.  
Все сборки получаю имя вида `zip_ep2k_xxx_yy.7z`, где `xxx_yy` номер версии ПО, извлекаемый из файла `ver.ini` находящегося в `/pkg`.  
`/arch` - директория хранения сборок ПО для выпуска извещений и сертификации.  
Формируемые сборки для извещений и сертификации находятся в поддиректориях вида `ep2k_xxx_yy`, где `xxx_yy` номер версии ПО.  
`/script` - скрипты автоматизации на `python`.

Полностью структура проекта сборки ПО описана в файле [structure](structure.md)

## Установка

Проект не требует установки. Все скрипты могут запускаться непосредственно из папки `/script`. Все пути в скриптах прописаны относительно корня папки проекта, поэтому сам проект может находится по любому пути.

### Зависимости

Скрипты сборки требуют наличие интерпретатора `python` версии `2.7` или выше.

В системе должен быть установлен архиватор `7z`, доступный в путях поиска.

## Сборка

### Сборка для распространения

Для получения архива сборки необходимо выполнить скрипт `ep2k_pkg.py` из директории `/script`:

    python ep2k_pkg.py

Скрипт при выполнении произведёт расчёт контрольных сумм CRC файлов рабочего ПО на БИ и сформирует файлы `ep2k_crc.txt` для всех вариантов установки ПО МПСУ-007. После этого скрипт извлечёт версию сборки ПО из `/pkg/program/ep2k/bi/diskc/ver.ini` и сформирует архив в директории `/distr`.

При вызове скрипта дополнительно можно указать модификатор сборки, который будет добавлен в конец имени архива и в поле версии файла `asm.txt` в корне сборки:

    python ep2k_pkg.py test

### Сборка для передачи в архив

В архив передаётся не только непосредственно сборка для распространения, но и все исходные и конфигурационные файлы, а также письма с основанием проведения доработки.

## Поддержка

Если у вас возникли сложности или вопросы по использованию пакета напишите на электронную почту <opo@zaoles.ru> указав в теме письма `ep2k_asm`.

## Документация

Пользовательскую документацию можно получить по [ссылке](doc/index.md)  
История изменений функционала ПО МПСУ-007 для ЭП2К находится в файле [changelog](changelog.md)  
История изменений версий ПО МПСУ-007 для ЭП2К находится в файле [changever](changever.md)  
История изменений в составе оборудования ЭП2К и МПСУ-007 находится в файле [changesys](changesys.md)  
Структура проекта сборки ПО находится в файле [structure](structure.md)

## Файлы сборок и развёртывание

Ссылки на все имеющиеся сборки находятся в описаниях сборок в документах [changelog](changelog.md) и [changever](changever.md).  
Официальная и крайняя, на данный момент времени, сборки находятся на [Яндекс.Диск:ЭП2К][]  
ПО для создания установочного образа ОС и развёртывания сборки находятся на [Яндекс.Диск:UFD][]  

[Яндекс.Диск:ЭП2К]: https://yadi.sk/d/460xtRiSuARh3  
[Яндекс.Диск:UFD]: http://yadi.sk/d/4TvLKgEmGW76b  
